"""
–§–∞–π–ª –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ —Å–±–æ—Ä –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏ –æ—Ç –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤.

üîπ –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ–ø—É–ª—è—Ä–Ω–æ–π —Ç–µ–º—ã: –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç, –∫–∞–∫–∏–µ –ø–æ—Å—Ç—ã –≤—ã–∑–≤–∞–ª–∏ –Ω–∞–∏–±–æ–ª—å—à–∏–π –∏–Ω—Ç–µ—Ä–µ—Å.
üîπ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–∞: –§–æ—Ä–º–∏—Ä—É–µ—Ç –≤–æ–ø—Ä–æ—Å –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–æ–ø—É–ª—è—Ä–Ω–æ–π —Ç–µ–º—ã.
üîπ –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è: –ü—É–±–ª–∏–∫—É–µ—Ç –∑–∞–ø—Ä–æ—Å –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏ –≤ Telegram-–∫–∞–Ω–∞–ª–µ.
üîπ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫: –õ–æ–≥–∏—Ä—É–µ—Ç —Å–±–æ–∏ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Å–æ–æ–±—â–µ–Ω–∏–π.
"""

from telegram import Bot
from keys import TELEGRAM_BOT_TOKEN, CHAT_ID
from analytics import get_most_popular_topic
from logger import log_error

bot = Bot(token=TELEGRAM_BOT_TOKEN)

async def send_feedback_request():
    """üí¨ –ó–∞–ø—Ä–æ—Å –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤"""
    topic = get_most_popular_topic()
    feedback_text = f"üí¨ –ß—Ç–æ –≤–∞–º –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ –ø–æ–Ω—Ä–∞–≤–∏–ª–æ—Å—å –≤ –ø–æ—Å—Ç–∞—Ö –ø—Ä–æ {topic}? –ù–∞–ø–∏—à–∏—Ç–µ –Ω–∞–º!"

    try:
        await bot.send_message(chat_id=CHAT_ID, text=feedback_text)
    except Exception as e:
        log_error(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏: {e}")
